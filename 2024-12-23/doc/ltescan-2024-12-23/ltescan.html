<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
<!-- Created by GNU Texinfo 6.6, http://www.gnu.org/software/texinfo/ -->
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<title>LTE and NR Network scanner</title>

<meta name="description" content="LTE and NR Network scanner">
<meta name="keywords" content="LTE and NR Network scanner">
<meta name="resource-type" content="document">
<meta name="distribution" content="global">
<meta name="Generator" content="makeinfo">
<link href="#SEC_Contents" rel="contents" title="Table of Contents">
<style type="text/css">
<!--
a.summary-letter {text-decoration: none}
blockquote.indentedblock {margin-right: 0em}
div.display {margin-left: 3.2em}
div.example {margin-left: 3.2em}
div.lisp {margin-left: 3.2em}
kbd {font-style: oblique}
pre.display {font-family: inherit}
pre.format {font-family: inherit}
pre.menu-comment {font-family: serif}
pre.menu-preformatted {font-family: serif}
span.nolinebreak {white-space: nowrap}
span.roman {font-family: initial; font-weight: normal}
span.sansserif {font-family: sans-serif; font-weight: normal}
ul.no-bullet {list-style: none}
table {
    border-spacing: 0px;
    border-collapse: collapse;
}

th {
    border: 1px solid black;
    background-color: #c0f585;
    font-size: 14px;
    padding: 5px;
}

td {
    border: 1px solid black;
    padding: 2px 4px;
}

p>img {
    display: initial;
}


-->
</style>


</head>

<body lang="en">
<h1 class="settitle" align="center">LTE and NR Network scanner</h1>


<span id="SEC_Contents"></span>
<h2 class="contents-heading">Table of Contents</h2>

<div class="contents">
<ul class="no-bullet">
<li><a id="toc-Introduction" href="#Introduction">1 Introduction</a></li>
<li><a id="toc-Requirements" href="#Requirements">2 Requirements</a>
<ul class="no-bullet">
  <li><a id="toc-Hardware-requirements" href="#Hardware-requirements">2.1 Hardware requirements</a></li>
  <li><a id="toc-Software-requirements" href="#Software-requirements">2.2 Software requirements</a></li>
</ul></li>
<li><a id="toc-Installation" href="#Installation">3 Installation</a>
<ul class="no-bullet">
  <li><a id="toc-Linux-setup" href="#Linux-setup">3.1 Linux setup</a>
  <ul class="no-bullet">
    <li><a id="toc-Packages" href="#Packages">3.1.1 Packages</a></li>
    <li><a id="toc-OpenSSL" href="#OpenSSL">3.1.2 OpenSSL</a></li>
  </ul></li>
  <li><a id="toc-RRH-setup-1" href="#RRH-setup-1">3.2 RRH setup</a>
  <ul class="no-bullet">
    <li><a id="toc-Amarisoft-PCIe-SDR" href="#Amarisoft-PCIe-SDR">3.2.1 Amarisoft PCIe SDR</a></li>
  </ul></li>
  <li><a id="toc-LTESCAN-installation" href="#LTESCAN-installation">3.3 LTESCAN installation</a></li>
</ul></li>
<li><a id="toc-Configuration-reference" href="#Configuration-reference">4 Configuration reference</a>
<ul class="no-bullet">
  <li><a id="toc-Configuration-file-syntax" href="#Configuration-file-syntax">4.1 Configuration file syntax</a>
  <ul class="no-bullet">
    <li><a id="toc-JSON-merge-rules-1" href="#JSON-merge-rules-1">4.1.1 JSON merge rules</a></li>
  </ul></li>
  <li><a id="toc-Global-properties" href="#Global-properties">4.2 Global properties</a></li>
</ul></li>
<li><a id="toc-Remote-API-1" href="#Remote-API-1">5 Remote API</a>
<ul class="no-bullet">
  <li><a id="toc-Messages" href="#Messages">5.1 Messages</a></li>
  <li><a id="toc-Startup" href="#Startup">5.2 Startup</a></li>
  <li><a id="toc-Errors" href="#Errors">5.3 Errors</a></li>
  <li><a id="toc-Sample-nodejs-program" href="#Sample-nodejs-program">5.4 Sample nodejs program</a></li>
  <li><a id="toc-Common-messages" href="#Common-messages">5.5 Common messages</a></li>
  <li><a id="toc-LTE-messages-1" href="#LTE-messages-1">5.6 LTE messages</a></li>
  <li><a id="toc-LTE-events" href="#LTE-events">5.7 LTE events</a></li>
  <li><a id="toc-Examples" href="#Examples">5.8 Examples</a></li>
</ul></li>
<li><a id="toc-Command-line-monitor-reference" href="#Command-line-monitor-reference">6 Command line monitor reference</a></li>
<li><a id="toc-Log-file-format-1" href="#Log-file-format-1">7 Log file format</a>
<ul class="no-bullet">
  <li><a id="toc-PHY-layer" href="#PHY-layer">7.1 PHY layer</a></li>
</ul></li>
<li><a id="toc-Change-history" href="#Change-history">8 Change history</a>
<ul class="no-bullet">
  <li><a id="toc-Version-2024_002d12_002d13" href="#Version-2024_002d12_002d13">8.1 Version 2024-12-13</a></li>
  <li><a id="toc-Version-2024_002d09_002d13" href="#Version-2024_002d09_002d13">8.2 Version 2024-09-13</a></li>
  <li><a id="toc-Version-2024_002d06_002d14" href="#Version-2024_002d06_002d14">8.3 Version 2024-06-14</a></li>
  <li><a id="toc-Version-2024_002d03_002d15" href="#Version-2024_002d03_002d15">8.4 Version 2024-03-15</a></li>
  <li><a id="toc-Version-2023_002d12_002d15" href="#Version-2023_002d12_002d15">8.5 Version 2023-12-15</a></li>
  <li><a id="toc-Version-2023_002d06_002d10" href="#Version-2023_002d06_002d10">8.6 Version 2023-06-10</a></li>
  <li><a id="toc-Version-2023_002d03_002d17" href="#Version-2023_002d03_002d17">8.7 Version 2023-03-17</a></li>
  <li><a id="toc-Version-2022_002d12_002d16" href="#Version-2022_002d12_002d16">8.8 Version 2022-12-16</a></li>
  <li><a id="toc-Version-2022_002d06_002d17" href="#Version-2022_002d06_002d17">8.9 Version 2022-06-17</a></li>
  <li><a id="toc-Version-2022_002d03_002d18" href="#Version-2022_002d03_002d18">8.10 Version 2022-03-18</a></li>
</ul></li>
<li><a id="toc-License" href="#License">9 License</a></li>

</ul>
</div>


<span id="Introduction"></span><h2 class="chapter">1 Introduction</h2>

<br>
<p>LTESCAN is a tool using Amarisoft SDR50 boards to scan a band of the
    RF spectrum searching for either LTE or NR (SA) cells.
    <br>
    LTESCAN can be greatly accelerated by using several boards together.
    <br>
    Depending on conditions, adding a LNA RF amplifier in front of the SDR50
    board(s) may give a better detection performance.
    <br>
    Launching &ldquo;ltescan&rdquo; will use the default config file &ldquo;ltescan.cfg&rdquo;.
    You can also specify a different config file by launching &ldquo;ltescan myscan.cfg&rdquo;
    Once launched, there are two ways to use it:
</p>    
<ul class="no-bullet">
<li>- user input on the console, with results on the screen
      </li><li>- websocket API for automatization

</li></ul>



<span id="Requirements"></span><h2 class="chapter">2 Requirements</h2>

<span id="Hardware-requirements"></span><h3 class="section">2.1 Hardware requirements</h3>

<ul class="no-bullet">
<li>- A fast PC:

<ul class="no-bullet">
<li>- For best performances, a quad core Intel Core i7 CPU (Haswell
  architecture or later) is recommended. Support of the AVX2 instruction set
  extension is required to run the software.

</li><li>- At least 2 GB of RAM.

</li><li>- At least 1 GB of hard disk space.

</li><li>- The video adapter does not matter.

</li></ul>

</li><li>- Radio front end

<p>one or more Amarisoft PCIe SDR50    
</p>
</li><li>- Appropriate antennas for the intended LTE frequencies
or cables and attenuators to connect to a UE.

</li><li>- Optional RF amplifier

</li></ul>

<span id="Software-requirements"></span><h3 class="section">2.2 Software requirements</h3>

<ul>
<li> A 64 bit Linux distribution. Fedora 39 is the officially supported distribution.<br>
The following distributions are known as compatible:
<ul>
<li> Fedora 22 to 39
</li><li> Cent OS 7
</li><li> Ubuntu 14 to 22
</li></ul>

<p>Your system requires at least GLIBC 2.17.
</p>

<p>Other distributions can be used provided the radio frontend drivers are available for them.<br>
</p>
</li></ul>


<span id="Installation"></span><h2 class="chapter">3 Installation</h2>

<span id="Linux-setup"></span><h3 class="section">3.1 Linux setup</h3>

<span id="Packages"></span><h4 class="subsection">3.1.1 Packages</h4>

<span id="openssl"></span><span id="OpenSSL"></span><h4 class="subsection">3.1.2 OpenSSL</h4>


<p>LTESCAN has been compiled against openssl version 1.1.1w.<br>
If your system does not have compatible version installed you may have this error message at startup:
</p><div class="example">
<pre class="example">error while loading shared libraries: libssl.so.1.1: cannot open shared object file: No such file or directory
</pre></div>

<p>To overcome this problem, you may:
</p><ul>
<li> Copy libssl.so.1.1 and libcrypto.so.1.1 from
<code>libs</code> subdirectory of your release tarball.<br>
If you have installed software with automatic install script, this should have been done automatically.



</li><li> Compile and install proper openssl version yourself

</li></ul>

<p>In case of persisting issue, raise a ticket from our support site at <a href="https://support.amarisoft.com/">https://support.amarisoft.com/</a>
with the information provided by below commands executed in LTESCAN directory:
</p><div class="example">
<pre class="example">uname -a
ls -l
ldd ./ltescan
openssl version
</pre></div>




<span id="RRH-setup"></span><span id="RRH-setup-1"></span><h3 class="section">3.2 RRH setup</h3>

<p>Please refer to sub section of your radio frontend to set it up.<br>
</p>
<span id="Amarisoft-PCIe-SDR"></span><h4 class="subsection">3.2.1 Amarisoft PCIe SDR</h4>

<p>Read the PCIe SDR documentation (<samp>trx_sdr.pdf</samp>).
</p>
<span id="LTESCAN-installation"></span><h3 class="section">3.3 LTESCAN installation</h3>

<p>Decompress the LTESCAN archive to a convenient place. The executable <code>ltescan</code> can be launched from this directory.
</p>

<span id="Configuration-reference"></span><h2 class="chapter">4 Configuration reference</h2>

<span id="Configuration-file-syntax"></span><h3 class="section">4.1 Configuration file syntax</h3>

<p>The main configuration file uses a syntax very similar to the
Javascript Object Notation (JSON) with few extensions.
</p>
<ol>
<li> Supported types:

<ul class="no-bullet">
<li>- Numbers (64 bit floating point). Notation: <code>13.4</code>
</li><li>- Complex numbers. Notation: <code>1.2+3*I</code>
</li><li>- Strings. Notation: <code> &quot;string&quot; </code>
</li><li>- Booleans. Notation: <code>true</code> or <code>false</code>.
</li><li>- Objects. Notation: <code> { field1: <var>value1</var>, field2: <var>value2</var>, .... } </code>
</li><li>- Arrays. Notation: <code> [ <var>value1</var>, <var>value2</var>, .... ] </code>
</li></ul>

</li><li> The basic operations <code>+</code>, <code>-</code>, <code>*</code> and <code>/</code> are
supported with numbers and complex numbers. <code>+</code> also concatenates
strings. The operators <code>!</code>, <code>||</code>, <code>&amp;&amp;</code>, <code>==</code>,
<code>!=</code>, <code>&lt;</code>, <code>&lt;=</code>, <code>&gt;=</code>, <code>&gt;</code> are supported too.

</li><li> The numbers <code>0</code> and <code>1</code> are accepted as synonyms for the
boolean values <code>false</code> and <code>true</code>.

</li><li> {} at top level are optional.

</li><li> &quot; for property names are optional, unless the name starts with a number.

</li><li> Properties can be duplicated.<br>
If properties are duplicated, they will be merged following <a href="#JSON-merge-rules">JSON merge rules</a> with overriding
occuring in reading direction (last overrides previous).<br>
Ex:
<pre class="verbatim">{
    value: &quot;foo&quot;,
    value: &quot;bar&quot;,
    sub: {
        value: &quot;foo&quot;
    },
    sub: {
        value: &quot;bar&quot;
    }
}
</pre><p>Will be equivalent to:
</p><pre class="verbatim">{
    value: &quot;bar&quot;,
    sub: {
        value: &quot;bar&quot;
    }
}
</pre>


</li><li> Files can be included using <var>include</var> keyword (must not be quoted) followed by a string (without :) representing the file to include (path is relative to current file) and terminating by a comma.<br>
Arrays can&rsquo;t be included.<br>
Merge will be done as for duplicate properties.<br>
If <var>file1.cfg</var> is:
<pre class="verbatim">    value: &quot;foo&quot;,
    include &quot;file2.cfg&quot;,
    foo: &quot;foo&quot;
</pre><p>And <var>file2.cfg</var> is:
</p><pre class="verbatim">    value: &quot;bar&quot;,
    foo: &quot;bar&quot;
</pre><p>Final config will be:
</p><pre class="verbatim">{
    value: &quot;bar&quot;,
    foo: &quot;foo&quot;
}
</pre>
</li><li> A C like preprocessor is supported. The following preprocessor commands are available:
  <dl compact="compact">
<dt><code>#define <var>var</var> <var>expr</var></code></dt>
<dd><p>Define a new variable with value <var>expr</var>. <var>expr</var> must be a
  valid JSON expression. Note that unlike the standard C preprocessor,
  <var>expr</var> is evaluated by the preprocessor.
  </p></dd>
<dt><code>#undef <var>var</var></code></dt>
<dd><p>Undefine the variable <var>var</var>.
  </p></dd>
<dt><code>#include <var>expr</var></code></dt>
<dd><p>Include the file whose filename is the evaluation of the string
  expression <var>expr</var>.
  </p></dd>
<dt><code>#if <var>expr</var></code></dt>
<dd><p>Consider the following text if <var>expr</var> is true.
  </p></dd>
<dt><code>#else</code></dt>
<dd><p>Alternative of <code>#if</code> block.
  </p></dd>
<dt><code>#elif</code></dt>
<dd><p>Composition of <code>#else</code> and <code>#if</code>.
  </p></dd>
<dt><code>#endif</code></dt>
<dd><p>End of <code>#if</code> block.
  </p></dd>
<dt><code>#ifdef <var>var</var></code></dt>
<dd><p>Shortcut for <code>#if defined(var)</code>
  </p></dd>
<dt><code>#ifndef <var>var</var></code></dt>
<dd><p>Shortcut for <code>#if !defined(var)</code>
  </p></dd>
</dl>

<p>In the JSON source, every occurrence of a defined preprocessor
  variable is replaced by its value.
</p>
</li><li> Backquote strings: JSON expression can be inserted in backquote delimited strings with the <code>${expr}</code> syntax. Example: <code>`abc${1+2}d`</code> is evaluated as the string <code>&quot;abc3d&quot;</code>. Preprocessor variables can be used inside the expression. Backquote strings may span several lines.

</li></ol>


<span id="JSON-merge-rules"></span><span id="JSON-merge-rules-1"></span><h4 class="subsection">4.1.1 JSON merge rules</h4>

<p>Merge overriding direction depends on context, i.e source may override destination or the opposite.<br>
JSON merge is recursive for Objects and Arrays.<br>
</p>
<p>Example, merging
</p><pre class="verbatim">{
    foo: { value: &quot;bar&quot; },
    same: &quot;one&quot;,
    one: 1
}
</pre><p>with
</p><pre class="verbatim">{
    foo: { value: &quot;none&quot;, second: true },
    same: &quot;two&quot;,
    two: 1
}
</pre>
<p>Will become:
</p><pre class="verbatim">{
    foo: { value: &quot;bar&quot;, second: true },
    same: &quot;one&quot;,
    one: 1
    two: 1
}
</pre><p>assuming first object overrides second one.<br>
</p>

<p>In case of Array merging, the final array length will be the maximum length of all merged arrays.<br>
For each element of the final array, merge will be done considering defined elements only.<br>
Ex:
</p><pre class="verbatim">{
    array: [0, 1, 2, { foo: &quot;bar&quot; } ],
    array: [3, 4],
    array: [5, 6, 7, { bar: &quot;foo&quot; }, 8 ]
}
</pre><p>Will be merged to:
</p><pre class="verbatim">{
    array: [5, 6, 7, { foo: &quot;bar&quot;, bar: &quot;foo&quot; }, 8 ],
}
</pre>


<span id="Global-properties"></span><h3 class="section">4.2 Global properties</h3>
<br>
<p>Example of ltescan.cfg:
<br>
</p><pre class="verbatim">/* LTE scan configuration */
{
  log_options: &quot;all.level=debug,all.max_size=1,phy.signal=1&quot;,
  log_filename: &quot;/tmp/scan.log&quot;,

  com_addr: &quot;[::]:9009&quot;,

  rf_driver: {
      name: &quot;sdr&quot;,        
      args: `dev0=/dev/sdr0`,
      /* For multiple boards */
      //args: `dev0=/dev/sdr0,dev1=/dev/sdr1,dev2=/dev/sdr2,dev3=/dev/sdr3`,
  },

  rx_gain: 60,
  
  scan: {
    lock_timeout: 100,    /* ms: waiting for Cell Lock */
    pbch_timeout: 200,    /* ms waiting for PBCH */
    sib_timeout: 3000,    /* ms: waiting for SIB */
    
    snr_threshold: 3.0,   /* only show cells with SNR greater than 3dB */
    rssi_timeout: 1000,   /* RSSI integration time (ms) */
    rssi_width: 100,      /* RSSI block width for rssi results (KHz) */
  },
}
</pre><br>
<p>For UHD driver (B2x0 hardware), the rf_driver must be modified as follows:
<br>
</p><pre class="verbatim">  rf_driver: {
      name: &quot;uhd&quot;,
      args: &quot;num_recv_frames=64,num_send_frames=64&quot;,
      dl_sample_bits: 12,
      ul_sample_bits: 12,
  },
</pre><br>

<!-- prop: -->

<dl compact="compact">
<dt><code>log_filename</code></dt>
<dd>
<p>String. Set the log filename. If no leading <code>/</code>, it is relative to the
configuration file path. See <a href="#Log-file-format">Log file format</a>.
</p>
<span id="log_005foptions"></span></dd>
<dt><code>log_options</code></dt>
<dd>
<p>String. Set the logging options as a comma separated list of assignments.
</p>
<ul>
<li> <var>layer</var>.level=<var>verbosity</var>. For each layer, the log verbosity can be set
to <code>none</code>, <code>error</code>, <code>info</code> or <code>debug</code>. In debug
level, the content of the transmitted data is logged.

</li><li> <var>layer</var>.max_size=<var>n</var>. When dumping data content, at
most <code>n</code> bytes are shown in hexa. For ASN.1, NAS or Diameter content, show the full content of the message if <code>n &gt; 0</code>.

</li><li> <var>layer</var>.payload=[0|1]. Dump ASN.1, NAS, SGsAP or Diameter payload in hexadecimal.

</li><li> <var>layer</var>.key=[0|1]. Dump security keys (NAS and RRC layers).

</li><li> <var>layer</var>.crypto=[0|1]. Dump plain and ciphered data (NAS and PCDP layers).





</li><li> time=[sec|short|full]. Display the time as seconds, time only
or full date and time (default = time only).

</li><li> time.us=[0|1]. Dump time with microseconds precision.

</li><li> file=cut. Close current file log and open a new one.

</li><li> file.rotate=now. Rename current log with timestamp and open new one.

</li><li> file.rotate=<var>size</var>. Rename current log every time it reaches <var>size</var> bytes open new one.
  Size is an integer and can be followed by K, M or G.

</li><li> file.path=<var>path</var>. When log rotation is enabled, move current log to this path instead of
  initial log path.

</li><li> append=[0|1]. (default=0). If 0, truncate the log file when
  opening it. Otherwise, append to it.

</li></ul>

<p>Available layers are: <code>phy</code>
</p>
</dd>
<dt><code>log_sync</code></dt>
<dd><p>Optional boolean (default = false). If true, logs will be synchronously dumped to file.<br>
  Warning, this may lead to performances decrease.
</p>

<span id="rx_005fgain"></span></dd>
<dt><code>rx_gain</code></dt>
<dd><p>Float. Receive gain in dB. The range is device
dependent. For the PCIe SDR board, the range is between -11 and 77 dB
(the exact limits depend on the RX frequency). For the USRP N2x0
device with the SBX daughterboard, the range is 0 to 31.5 dB. With an
array of floats a different gain is specified for each channel.
Ltescan uses this value as initial rx_gain fo each new frequenncy.
The actual gain is automatically lowered as needed.
</p>
</dd>
<dt><code>scan</code></dt>
<dd><p>Object. Section for scanning parameters
    </p><dl compact="compact">
<dt><code>lock_timeout</code></dt>
<dd><p>Number. Timeout in ms waiting for cell lock on a frequency. (default = 100ms)
</p>
</dd>
<dt><code>pcbh_timeout</code></dt>
<dd><p>Number. Timeout in ms waiting for PBCH (LTE) or PDCCH (NR) when locked on a frequency. (default = 200ms)
</p>
</dd>
<dt><code>sib_timeout</code></dt>
<dd><p>Number. Timeout in ms waiting for cell SIB (LTE) or MIB (NR) on a frequency when locked. (default = 3000 ms)
</p>
</dd>
<dt><code>snr_threshold</code></dt>
<dd><p>Float. Minimum SNR in dB to accept SIB or MIB. (default = 3.0 dB)
</p>
</dd>
<dt><code>rssi_timeout</code></dt>
<dd><p>Number. Time in ms integrating data when scanning RSSI (default = 100 ms)
</p>    
</dd>
<dt><code>rssi_width</code></dt>
<dd><p>Number. Frequency step in KHz when returning RSSI scan result. (granularity = 100KHz, default = 100 KHz)
</p>
</dd>
<dt><code>band</code></dt>
<dd><p>Number or String. Optional parameter to force automatic scan when ltescan is launched.
    Accepts same syntax as the &rsquo;scan&rsquo; command on command line (see Chapter 6).
</p>
</dd>
</dl>

<span id="sib_005fformat_005fjer"></span></dd>
<dt><code>sib_format_jer</code></dt>
<dd><p>Optional boolean (default = false). If set, sib ASN.1 content within <a href="#Cell-notification">Cell notification</a>
message will be a JSON structure (JER) instead base64 encoding.
</p>
</dd>
<dt><code>com_addr</code></dt>
<dd><p>Optional string. Address of the WebSocket server remote API. See <a href="#Remote-API">Remote API</a>.<br>
If set, the WebSocket server for remote API will be enabled and bound to this address.<br>
Default port is 9009.<br>
Setting IP address to [::] will make remote API reachable through all network interfaces.
</p>
</dd>
<dt><code>com_name</code></dt>
<dd><p>Optional string. Sets server name. SCAN by default
</p>

</dd>
<dt><code>com_ssl_certificate</code></dt>
<dd><p>Optional string. If set, forces SSL for WebSockets. Defines CA
certificate filename.
</p>
</dd>
<dt><code>com_ssl_key</code></dt>
<dd><p>Optional string. Mandatory if <var>com_ssl_certificate</var> is set. Defines CA
private key filename.
</p>
</dd>
<dt><code>com_ssl_peer_verify</code></dt>
<dd><p>Optional boolean (default is false). If <var>true</var>, server will check
client certificate.
</p>
</dd>
<dt><code>com_ssl_ca</code></dt>
<dd><p>Optional string. Set CA certificate. In case of peer verification with self signed
certificate, you should use the client certificate.
</p>

</dd>
<dt><code>com_log_lock</code></dt>
<dd><p>Optional boolean (default is false). If <var>true</var>, logs configuration can&rsquo;t be changed
via <code>config_set</code> remote API.
</p>
</dd>
<dt><code>com_log_us</code></dt>
<dd><p>Optional boolean (default is false). If <var>true</var>, logs sent by <code>log_get</code> remote API
response will have a <code>timestamp_us</code> parameters instead of <code>timestamp</code>
</p>
</dd>
<dt><code>com_auth</code></dt>
<dd><p>Optional object. If set, remote API access will require authentication.<br>
Authentication mechanism is describe in <a href="#Remote-API-Startup">Remote API Startup</a> section.<br>
</p>
<dl compact="compact">
<dt><code>passfile</code></dt>
<dd><p>Optional string. Defines filename where password is stored (plaintext).<br>
    If not set, <code>password</code> must be set
</p>
</dd>
<dt><code>password</code></dt>
<dd><p>Optional string. Defines password.<br>
    If not set, <code>passfile</code> must be set.
</p>
</dd>
<dt><code>unsecure</code></dt>
<dd><p>Optional boolean (default  false). If set, allow password to be sent plaintext.<br>
    NB: you should set it to true if you access it from a Web Browser (Ex: Amarisoft GUI)
    without SSL (https) as your Web Browser may prevent secure access to work.
</p>
</dd>
</dl>

</dd>
<dt><code>com_log_count</code></dt>
<dd><p>Optional number (Default = 8192). Defines number of logs to keep in memory before dropping them.<br>
Must be between 4096 and 2097152).
</p>

<span id="sim_005fevents"></span></dd>
<dt><code>sim_events</code></dt>
<dd><p>Array of object. Each element gives an event configuration to execute for
  this UE.<br>
  Event configuration is exactly the same as for <a href="#Remote-API">Remote API</a> messages
  except that message field must be event.
</p>
</dd>
<dt><code>sim_events_loop_count</code></dt>
<dd><p>If set, will define <code>loop_count</code> for each event of <code>sim_events</code>, See <a href="#loop_005fcount">loop_count</a>.
</p>
</dd>
<dt><code>sim_events_loop_delay</code></dt>
<dd><p>If set, will define <code>loop_delay</code> for each event of <code>sim_events</code>, See <a href="#loop_005fdelay">loop_delay</a>.
</p>


</dd>
<dt><code>license_server</code></dt>
<dd><p>Configuration of the Amarisoft license server to use.<br>
Object with following properties:
</p>
<dl compact="compact">
<dt><code>server_addr</code></dt>
<dd><p>String. IP address of the license server.
</p></dd>
<dt><code>name</code></dt>
<dd><p>Optional string. Text to be displayed inside server monitor or remote API.
</p></dd>
<dt><code>tag</code></dt>
<dd><p>Optional string. If set, server will only allow license with same tag.
</p></dd>
</dl>

<p>Example:
</p><pre class="verbatim">license_server: {
    server_addr: &quot;192.168.0.20&quot;,
    name: &quot;My license&quot;
}
</pre>

</dd>
</dl>


<span id="Remote-API"></span><span id="Remote-API-1"></span><h2 class="chapter">5 Remote API</h2>

<p>You can access LTESCAN via a remote API.<br>
Protocol used is WebSocket as defined in RFC 6455
(<a href="https://tools.ietf.org/html/rfc6455">https://tools.ietf.org/html/rfc6455</a>).<br>
</p>
<p>Note that Origin header is mandatory for the server to accept connections.<br>
This behavior is determined by the use of <code>nopoll</code> library.<br>
Any value will be accepted.
</p>
<span id="Messages"></span><h3 class="section">5.1 Messages</h3>

<p>Messages exchanged between client and LTESCAN server are in strict JSON
format.<br>
</p>
<p>Each message is represented by an object. Multiple message can be sent to
server using an array of message objects.<br>
</p>
<p>Time and delay values are floating number in seconds.<br>
</p>
<p>There are 3 types of messages:
</p>
<ul>
<li> Request

<p>Message sent by client.<br>
Common definition:
</p>
<!-- prop:request -->

<dl compact="compact">
<dt><code>message</code></dt>
<dd><p>String. Represent type of message. This parameter is mandatory and depending
  on its value, other parameters will apply.<br>
</p>
</dd>
<dt><code>message_id</code></dt>
<dd><p>Optional any type. If set, response sent by the server to this message will
  have same message_id. This is used to identify response as WebSocket does not
  provide such a concept.
</p>
</dd>
<dt><code>start_time</code></dt>
<dd><p>Optional float. Represent the delay before executing the message.<br>
  If not set, the message is executed when received.<br>
</p>
</dd>
<dt><code>absolute_time</code></dt>
<dd><p>Optional boolean (default = false). If set, <code>start_time</code> is interpreted as absolute.<br>
  You can get current clock of system using <code>time</code> member of any response.
</p>
</dd>
<dt><code>standalone</code></dt>
<dd><p>Optional boolean (default = false). If set, message will survive WebSocket disconnection,
  else, if socket is disconnected before end of processing, the message will be cancelled.
</p>
<span id="loop_005fcount"></span></dd>
<dt><code>loop_count</code></dt>
<dd><p>Optional integer (default = 0, max = 1000000). If set, message will be repeated <code>loop_count</code> time(s)
  after <code>loop_delay</code> (From message beginning of event).<br>
  Response will have a <code>loop_index</code> to indicate iteration number.
</p>
<span id="loop_005fdelay"></span></dd>
<dt><code>loop_delay</code></dt>
<dd><p>Optional number (min = 0.1, max = 86400). Delay in seconds to repeat message from its <code>start_time</code>.
  Mandatory when <code>loop_count</code> is set &gt; 0.
</p>
</dd>
</dl>

</li><li> Response

<p>Message sent by server after any request message as been processed.<br>
Common definition:
</p>
<!-- prop:response -->

<dl compact="compact">
<dt><code>message</code></dt>
<dd><p>String. Same as request.
</p>
</dd>
<dt><code>message_id</code></dt>
<dd><p>Optional any type. Same as in request.
</p>
</dd>
<dt><code>time</code></dt>
<dd><p>Number representing time in seconds since start of the process.<br>
  Usefull to send command with absolute time.
</p>
</dd>
<dt><code>utc</code></dt>
<dd><p>Number representing UTC seconds.
</p>
</dd>
</dl>

</li><li> Events

<p>Message sent by server on its own initiative.<br>
Common definition:
</p>
<!-- prop:event -->

<dl compact="compact">
<dt><code>message</code></dt>
<dd><p>String. Event name.
</p>
</dd>
<dt><code>time</code></dt>
<dd><p>Number representing time in seconds.<br>
  Usefull to send command with absolute time.
</p>
</dd>
</dl>

</li></ul>


<span id="Remote-API-Startup"></span><span id="Startup"></span><h3 class="section">5.2 Startup</h3>


<p>When WebSocket connections is setup, LTESCAN will send a first message with
name set to <code>com_name</code> and type set to SCAN.<br>
</p>
<p>If authentication is not set, message will be <code>ready</code>:
</p>
<div class="example">
<pre class="example">{
    &quot;message&quot;: &quot;ready&quot;,
    &quot;type&quot;: &quot;SCAN&quot;,
    &quot;name&quot;: &lt;com_name&gt;,
    &quot;version&quot;: &lt;software version&gt;,
    &quot;product&quot;: &lt;Amarisoft product name (optional)&gt;
}
</pre></div>

<p>If authentication is set, message will be <code>authenticate</code> :
</p>
<div class="example">
<pre class="example">{
    &quot;message&quot;: &quot;authenticate&quot;,
    &quot;type&quot;: &quot;SCAN&quot;,
    &quot;name&quot;: &lt;com_name&gt;,
    &quot;challenge&quot;: &lt;random challenge&gt;
}
</pre></div>

<p>To authenticate, the client must answer with a <code>authenticate</code> message
and a <code>res</code> parameter where:
</p>
<div class="example">
<pre class="example">res = HMAC-SHA256( &quot;&lt;type&gt;:&lt;password&gt;:&lt;name&gt;&quot;, &quot;&lt;challenge&gt;&quot; )
</pre></div>

<p><code>res</code> is a string and HMAC-SHA256 refers to the standard algorithm
(<a href="https://en.wikipedia.org/wiki/HMAC">https://en.wikipedia.org/wiki/HMAC</a>)
</p>
<p>If the authentication succeeds, the response will have a <code>ready</code> field
set to <code>true</code>.
</p>
<div class="example">
<pre class="example">{
    &quot;message&quot;: &quot;authenticate&quot;,
    &quot;message_id&quot;: &lt;message id&gt;,
    &quot;ready&quot;: true
}
</pre></div>

<p>If authentication fails, the response will have an <code>error</code> field and will
provide a new challenge.
</p>
<div class="example">
<pre class="example">{
    &quot;message&quot;: &quot;authenticate&quot;,
    &quot;message_id&quot;: &lt;message id&gt;,
    &quot;error&quot;: &lt;error message&gt;,
    &quot;type&quot;: &quot;SCAN&quot;,
    &quot;name: &lt;name&gt;,
    &quot;challenge&quot;: &lt;new random challenge&gt;
}
</pre></div>


<p>If any other message is sent before authentication succeeds,
the error <code>&quot;Authentication not done&quot;</code> will be sent as a response.
</p>

<span id="Errors"></span><h3 class="section">5.3 Errors</h3>

<p>If a message produces an error, response will have an error string field
representing the error.
</p>

<span id="Sample-nodejs-program"></span><h3 class="section">5.4 Sample nodejs program</h3>

<p>You will find in this documentation a sample program: <code>ws.js</code>.<br>
It is located in <code>doc</code> subdirectory.<br>
This is a nodejs program that allow to send message to LTESCAN.<br>
It requires nodejs to be installed:
</p><div class="example">
<pre class="example">dnf install nodejs npm
npm install nodejs-websocket
</pre></div>

<p>Use relevant package manager instead of NPM depending on your Linux distribution.<br>
</p>
<p>Then simply start it with server name and message you want to send:
</p><div class="example">
<pre class="example">./ws.js 127.0.0.1:9009 '{&quot;message&quot;: &quot;config_get&quot;}'
</pre></div>


<span id="Common-messages"></span><h3 class="section">5.5 Common messages</h3>

<dl compact="compact">
<dt><code>config_get</code></dt>
<dd><p>Retrieve current config.<br>
</p>
<p>Response definition:
    </p><dl compact="compact">
<dt><code>type</code></dt>
<dd><p>Always &quot;SCAN&quot;
</p>
</dd>
<dt><code>name</code></dt>
<dd><p>String representing server name.
</p>
<span id="config_005fget-logs-member"></span></dd>
<dt><code>logs</code></dt>
<dd><p>Object representing log configuration.<br>
      With following elements:
        </p><dl compact="compact">
<dt><code>layers</code></dt>
<dd><p>Object. Each member of the object represent a log layer configuration:
</p>
<dl compact="compact">
<dt><code>layer name</code></dt>
<dd><p>Object. The member name represent log layer name and parameters are:
</p>
<dl compact="compact">
<dt><code>level</code></dt>
<dd><p>See <a href="#log_005foptions">log_options</a>
                  </p></dd>
<dt><code>max_size</code></dt>
<dd><p>See <a href="#log_005foptions">log_options</a>
                  </p></dd>
<dt><code>key</code></dt>
<dd><p>See <a href="#log_005foptions">log_options</a>
                  </p></dd>
<dt><code>crypto</code></dt>
<dd><p>See <a href="#log_005foptions">log_options</a>
                  </p></dd>
<dt><code>payload</code></dt>
<dd><p>See <a href="#log_005foptions">log_options</a>
                </p></dd>
</dl>

</dd>
</dl>

</dd>
<dt><code>count</code></dt>
<dd><p>Number. Number of bufferizer logs.
</p>
</dd>
<dt><code>rotate</code></dt>
<dd><p>Optional number. Max log file size before rotation.
</p>
</dd>
<dt><code>path</code></dt>
<dd><p>Optional string. Log rotation path.
</p>
</dd>
<dt><code>bcch</code></dt>
<dd><p>Boolean. True if BCCH dump is enabled (eNB only).
</p>
</dd>
<dt><code>mib</code></dt>
<dd><p>Boolean. True if MIB dump is enabled (eNB only).
        </p></dd>
</dl>

</dd>
<dt><code>locked</code></dt>
<dd><p>Optional boolean. If <code>true</code>, logs configuration can&rsquo;t be changed
      with <code>config_set</code> API.
</p>

</dd>
</dl>


</dd>
<dt><code>log_get</code></dt>
<dd><p>Get logs.<br>
  This API has a per connection behavior. This means that the response will depend on previous calls
  to this API within the same WebSocket connection.<br>
  In practice, logs that have been provided in a response won&rsquo;t be part of subsequent request unless
  connection is reestablished. To keep on receiving logs, client should send a new <code>log_get</code> request
  as soon as the previous response has been received.<br>
  If a request is sent before previous request has been replied, previous request will be replied right now
  without considering specific min/max/timeout conditions.
</p>
<p>Message definition:
    </p><dl compact="compact">
<dt><code>min</code></dt>
<dd><p>Optional number (default = 1). Minimum amount of logs to retrieve.<br>
      Response won&rsquo;t be sent until this limit is reached (Unless timeout occurs).
</p>
</dd>
<dt><code>max</code></dt>
<dd><p>Optional number (default = 4096). Maximum logs sent in a response.
</p>
</dd>
<dt><code>timeout</code></dt>
<dd><p>Optional number (default = 1). If at least 1 log is available and no
      more logs have been generated for this time, response will be sent.
</p>
</dd>
<dt><code>allow_empty</code></dt>
<dd><p>Optional boolean (default = false). If set, response will be sent after timeout,
      event if no logs are available.
</p>
</dd>
<dt><code>rnti</code></dt>
<dd><p>Optional number. If set, send only logs matching rnti.
</p>
</dd>
<dt><code>ue_id</code></dt>
<dd><p>Optional number. If set, send only logs with matching ue_id.
</p>
</dd>
<dt><code>layers</code></dt>
<dd><p>Optional Object. Each member name represents a log layer and values must be
      string representing maximum level. See <a href="#log_005foptions">log_options</a>.<br>
      If <var>layers</var> is not set, all layers level will be set to <var>debug</var>,
      else it will be set to <var>none</var>.<br>
      Note also the logs is also limited by general log level. See <a href="#log_005foptions">log_options</a>.<br>
</p>
</dd>
<dt><code>short</code></dt>
<dd><p>Optional boolean (default = false). If set, only first line of logs will be dumped.
</p>
</dd>
<dt><code>headers</code></dt>
<dd><p>Optional boolean. If set, send log file headers.
</p>
</dd>
<dt><code>start_timestamp</code></dt>
<dd><p>Optional number. Is set, filter logs older than this value in milliseconds.
</p>
</dd>
<dt><code>end_timestamp</code></dt>
<dd><p>Optional number. Is set, filter logs more recent than this value in milliseconds.
</p>
</dd>
<dt><code>max_size</code></dt>
<dd><p>Optional number (default = 1048576, i.e. 1MB). Maximum size in bytes of the generated
      JSON message. If the response exceeds this size, the sending of logs will be
      forced independently from other parameters.
</p>
</dd>
</dl>

<p>Response definition:
    </p><dl compact="compact">
<dt><code>logs</code></dt>
<dd><p>Array. List of logs. Each item is a an object with following members:
        </p><dl compact="compact">
<dt><code>data</code></dt>
<dd><p>Array. Each item is a string representing a line of log.
</p>
</dd>
<dt><code>timestamp</code></dt>
<dd><p>Number. Milliseconds since January 1st 1970. Not present if <code>com_log_us</code> is set in configuration.<br>
</p>
</dd>
<dt><code>timestamp_us</code></dt>
<dd><p>Number. Microseconds since January 1st 1970. Only present if <code>com_log_us</code> is set in configuration.<br>
</p>
</dd>
<dt><code>layer</code></dt>
<dd><p>String. Log layer.
</p>
</dd>
<dt><code>level</code></dt>
<dd><p>String. Log level: <var>error</var>, <var>warn</var>, <var>info</var> or <var>debug</var>.
</p>
</dd>
<dt><code>dir</code></dt>
<dd><p>Optional string. Log direction: <var>UL</var>, <var>DL</var>, <var>FROM</var> or <var>TO</var>.
</p>
</dd>
<dt><code>ue_id</code></dt>
<dd><p>Optional number. UE_ID.
</p>
</dd>
<dt><code>cell</code></dt>
<dd><p>Optional number (only for PHY layer logs). Cell ID.
</p>
</dd>
<dt><code>rnti</code></dt>
<dd><p>Optional number (only for PHY layer logs). RNTI.
</p>
</dd>
<dt><code>frame</code></dt>
<dd><p>Optional number (only for PHY layer logs). Frame number (Subframe is decimal part).
</p>
</dd>
<dt><code>channel</code></dt>
<dd><p>Optional string (only for PHY layer logs). Channel name.
</p>
</dd>
<dt><code>src</code></dt>
<dd><p>String. Server name.
</p>
</dd>
<dt><code>idx</code></dt>
<dd><p>Integer. Log index.
</p>
</dd>
<dt><code>headers</code></dt>
<dd><p>Optional array. Array of strings.
</p>
</dd>
</dl>

</dd>
<dt><code>discontinuity</code></dt>
<dd><p>Optional number. If set, this means some logs have been discarded due to log buffer overflow.
</p>
</dd>
<dt><code>microseconds</code></dt>
<dd><p>Optional boolean. Present and set to true if <code>com_log_us</code> is set in configuration file.
    </p></dd>
</dl>

</dd>
<dt><code>log_set</code></dt>
<dd><p>Add log.<br>
  Message definition:
    </p><dl compact="compact">
<dt><code>log</code></dt>
<dd><p>Optional string. Log message to add. If set, <var>layer</var> and <var>level</var> are mandatory.
</p>
</dd>
<dt><code>layer</code></dt>
<dd><p>String. Layer name. Only mandatory if <var>log</var> is set.
</p>
</dd>
<dt><code>level</code></dt>
<dd><p>String. Log level: <var>error</var>, <var>warn</var>, <var>info</var> or <var>debug</var>. Only mandatory if <var>log</var> is set.
</p>
</dd>
<dt><code>dir</code></dt>
<dd><p>Optional string. Log direction: <var>UL</var>, <var>DL</var>, <var>FROM</var> or <var>TO</var>.
</p>
</dd>
<dt><code>ue_id</code></dt>
<dd><p>Optional number. UE_ID.
</p>
</dd>
<dt><code>flush</code></dt>
<dd><p>Optional boolean (default = false). If set, flushes fog file.
</p>
</dd>
<dt><code>rotate</code></dt>
<dd><p>Optional boolean (default = false). If set, forces log file rotation.
</p>
</dd>
<dt><code>cut</code></dt>
<dd><p>Optional boolean (default = false). If set, forces log file reset.
</p>
</dd>
</dl>


</dd>
<dt><code>log_reset</code></dt>
<dd><p>Resets logs buffer.
</p>
</dd>
<dt><code>license</code></dt>
<dd><p>Retrieves license file information.
</p>
</dd>
<dt><code>quit</code></dt>
<dd><p>Terminates ltescan.
</p>
</dd>
<dt><code>help</code></dt>
<dd><p>Provides list of available messages in <var>messages</var> array of strings
  and events to register in <var>events</var> array of strings.<br>
</p>
</dd>
<dt><code>stats</code></dt>
<dd><p>Report statistics for LTESCAN.<br>
  Every time this message is received by server, statistics are reset.<br>
  Warning, calling this message from multiple connections simultaneously will modify the
  statistics sampling time.
</p>

<p>Response definition:
    </p><dl compact="compact">
<dt><code>cpu</code></dt>
<dd><p>Object. Each member name defines a type and its value cpu load in % of one core.
</p>
</dd>
<dt><code>instance_id</code></dt>
<dd><p>Number. Constant over process lifetime. Changes on process restart.
</p>


</dd>
</dl>

</dd>
<dt><code>register</code></dt>
<dd><p>Register client to message generated by server.
  Message definition:
    </p><dl compact="compact">
<dt><code>register</code></dt>
<dd><p>String or array of string. List of message to register to.<br>
      Can be <code>cell</code>, <code>scan</code>
</p>
</dd>
<dt><code>unregister</code></dt>
<dd><p>String or array of string. List of message to unregister.<br>
      Can be <code>cell</code>, <code>scan</code>
</p>
</dd>
</dl>


</dd>
</dl>



<span id="LTE-messages"></span><span id="LTE-messages-1"></span><h3 class="section">5.6 LTE messages</h3>

<dl compact="compact">
<dt><code>scan</code></dt>
<dd><p>Launches a scan on selected bands.<br>
  The response is sent when scanning is over.<br>
  During scanning, notification intermediate message will be sent to notify progress.<br>
  Closing connection before end of scan does not stop scanning.<br>
  If a scanning is already in progress, it will be stopped.
  Message definition:
    </p><dl compact="compact">
<dt><code>band</code></dt>
<dd><p>Number, string, object or array. Defines the list of bands to scan.<br>
      If an array is defined, all elements must be a number, string or object.<br>
      A number represents a LTE band number to scan.<br>
      A string represents a single band with the command line syntax (see below).
        </p><dl compact="compact">
<dt><code><code>7</code></code></dt>
<dd><p>band LTE 7
        </p></dd>
<dt><code><code>7(3000)</code></code></dt>
<dd><p>arfcn 30000 of band LTE 7
        </p></dd>
<dt><code><code>n78(7838,7850)</code></code></dt>
<dd><p>gscn 7838 to 7850 on band NR 78        
        </p></dd>
</dl>
<p>An object will have following properties:
        </p><dl compact="compact">
<dt><code>band</code></dt>
<dd><p>Number. Band to scan
        </p></dd>
<dt><code>type</code></dt>
<dd><p>String. Can be <code>nr</code> or <code>lte</code>.
        </p></dd>
</dl>
</dd>
</dl>

<span id="Cell-notification"></span><p>Cell notification.
  Every time a cell is found, such notification is sent.
    </p><dl compact="compact">
<dt><code>notification</code></dt>
<dd><p>String. Set as <code>cell</code>
      </p></dd>
<dt><code>band</code></dt>
<dd><p>Number. Band
      </p></dd>
<dt><code>type</code></dt>
<dd><p>String. Can be <code>nr</code> or <code>lte</code>.
      </p></dd>
<dt><code>frequency</code></dt>
<dd><p>Number. Cell center frequency in Hz.
      </p></dd>
<dt><code>dl_earfcn</code></dt>
<dd><p>Number. Downlink earfcn (LTE only).
      </p></dd>
<dt><code>dl_arfcn</code></dt>
<dd><p>Number. Downlink arfcn (NR only).
      </p></dd>
<dt><code>gscn</code></dt>
<dd><p>Number. SSB gscn (NR only).
      </p></dd>
<dt><code>nsa</code></dt>
<dd><p>Optional boolean. Cell only supports NSA (no SIB1 scheduled, NR only).
      </p></dd>
<dt><code>mib</code></dt>
<dd><p>String. Content of MIB in base64 encoding.
      </p></dd>
<dt><code>bandwidth</code></dt>
<dd><p>Number. Cell bandwidth in MHz.
      </p></dd>
<dt><code>n_rb_dl</code></dt>
<dd><p>Number. Number of resource blocks.
      </p></dd>
<dt><code>rssi</code></dt>
<dd><p>Number. RSSI in dBm.
      </p></dd>
<dt><code>rsrq</code></dt>
<dd><p>Number. RSRQ in dB
      </p></dd>
<dt><code>rsrp</code></dt>
<dd><p>Number. RSRP in dBm.
      </p></dd>
<dt><code>snr</code></dt>
<dd><p>Number. SNR in dB.
      </p></dd>
<dt><code>n_antenna_pbch</code></dt>
<dd><p>Number. Number of antenna as reported in the PBCH (LTE only)
      </p></dd>
<dt><code>lte_m</code></dt>
<dd><p>Boolean. Cell supports LTE-M (LTE only)
      </p></dd>
<dt><code>n_ssb</code></dt>
<dd><p>Number. Number of SSB (antennas) from &rsquo;ssb-PositionsInBurst&rsquo; in SIB1 (NR only)
      </p></dd>
<dt><code>ssb_index</code></dt>
<dd><p>Number. SSB index as reported in MIB (NR only)
      </p></dd>
<dt><code>ssb_subcarrier_spacing</code></dt>
<dd><p>Number. SSB subcarrier spacing in KHz (NR only)
      </p></dd>
<dt><code>subcarrier_spacing</code></dt>
<dd><p>Number. subcarrier spacing in KHz (NR only)
      </p></dd>
<dt><code>uldl_config</code></dt>
<dd><p>Number. uldl config if TDD mode (LTE only)
      </p></dd>
<dt><code>special_subframe_config</code></dt>
<dd><p>Number. special subframe config if TDD mode (LTE only)
      </p></dd>
<dt><code>tp1_period</code></dt>
<dd><p>Number. Period in ms of TDD Pattern_1 if TDD mode (NR only)
      </p></dd>
<dt><code>tp1_dl_slots</code></dt>
<dd><p>Number. Number of DL slots in Pattern_1 if TDD mode (NR only)
      </p></dd>
<dt><code>tp1_ul_slots</code></dt>
<dd><p>Number. Number of UL slots in Pattern_1 if TDD mode (NR only)
      </p></dd>
<dt><code>tp1_dl_symbs</code></dt>
<dd><p>Number. Number of DL symbols in special slot in Pattern_1 if TDD mode (NR only)
      </p></dd>
<dt><code>tp1_ul_symbs</code></dt>
<dd><p>Number. Number of UL symbols in special slot in Pattern_1 if TDD mode (NR only)
      </p></dd>
<dt><code>tp2_period</code></dt>
<dd><p>Number. Period in ms of TDD Pattern_2 if TDD mode (NR only)
      </p></dd>
<dt><code>tp2_dl_slots</code></dt>
<dd><p>Number. Number of DL slots in Pattern_2 if TDD mode (NR only)
      </p></dd>
<dt><code>tp2_ul_slots</code></dt>
<dd><p>Number. Number of UL slots in Pattern_2 if TDD mode (NR only)
      </p></dd>
<dt><code>tp2_dl_symbs</code></dt>
<dd><p>Number. Number of DL symbols in special slot in Pattern_2 if TDD mode (NR only)
      </p></dd>
<dt><code>tp2_ul_symbs</code></dt>
<dd><p>Number. Number of UL symbols in special slot in Pattern_2 if TDD mode (NR only)
      </p></dd>
<dt><code>sib1</code></dt>
<dd><p>String. Content of SIB1 (if broadcasted). May be base64 encoding or JER depending on <a href="#sib_005fformat_005fjer">sib_format_jer</a>.
      </p></dd>
<dt><code>sib2</code></dt>
<dd><p>String. Content of SIB2 (if broadcasted). May be base64 encoding or JER depending on <a href="#sib_005fformat_005fjer">sib_format_jer</a>.
      </p></dd>
<dt><code>sib3</code></dt>
<dd><p>String. Content of SIB3 (if broadcasted). May be base64 encoding or JER depending on <a href="#sib_005fformat_005fjer">sib_format_jer</a>.
      </p></dd>
<dt><code>sib4</code></dt>
<dd><p>String. Content of SIB4 (if broadcasted). May be base64 encoding or JER depending on <a href="#sib_005fformat_005fjer">sib_format_jer</a>.
      </p></dd>
<dt><code>sib5</code></dt>
<dd><p>String. Content of SIB5 (if broadcasted). May be base64 encoding or JER depending on <a href="#sib_005fformat_005fjer">sib_format_jer</a>.
    </p></dd>
</dl>

<p>Band notification.
  Every time a new band is being scanned, such notification is sent.
    </p><dl compact="compact">
<dt><code>notification</code></dt>
<dd><p>String. Set as <code>cell</code>
      </p></dd>
<dt><code>band</code></dt>
<dd><p>Number. Band
      </p></dd>
<dt><code>type</code></dt>
<dd><p>String. Can be <code>nr</code> or <code>lte</code>.
    </p></dd>
</dl>

</dd>
<dt><code>cells</code></dt>
<dd><p>Returns last scanning results.
  Response definition:
    </p><dl compact="compact">
<dt><code>cells</code></dt>
<dd><p>Array of object. Each item represents a cell as described in See <a href="#Cell-notification">Cell notification</a>.
      </p></dd>
<dt><code>scanning</code></dt>
<dd><p>Boolean. If true, a scanning is in progress.
    </p></dd>
</dl>

</dd>
<dt><code>scan_rssi</code></dt>
<dd><p>Launches a RSSI scan on selected bands.<br>
  Results are returneded by frequency step (defined by rssi_width parameter).
  During scanning, notification intermediate message will be sent to notify progress.<br>
  Closing connection before end of scan does not stop scanning.<br>
  If a scanning is already in progress, it will be stopped.
  Message definition:
    </p><dl compact="compact">
<dt><code>band</code></dt>
<dd><p>Number, object or array. Defines the list of bands to scan.<br>
      If an array is defined, all elements must be a number or an object.<br>
      A number represents a LTE band number to scan.
      An object will have following properties:
        </p><dl compact="compact">
<dt><code>band</code></dt>
<dd><p>Number. Band to scan
        </p></dd>
<dt><code>type</code></dt>
<dd><p>String. Can be <code>nr</code> or <code>lte</code>.
        </p></dd>
</dl>
</dd>
</dl>

<span id="RSSI-notification"></span><p>RSSI notification.
  For every frequency step, a notification is sent.
    </p><dl compact="compact">
<dt><code>notification</code></dt>
<dd><p>String. Set as <code>rssi</code>
</p>      
</dd>
<dt><code>frequency</code></dt>
<dd><p>Number. Frequency in Hz.
      </p></dd>
<dt><code>arfcn</code></dt>
<dd><p>Number. Downlink arfcn (LTE only).
      </p></dd>
<dt><code>rssi</code></dt>
<dd><p>Number. RSSI in dBm.
    </p></dd>
</dl>

</dd>
<dt><code>rssis</code></dt>
<dd><p>Returns last RSSI scanning results.
  Response definition:
    </p><dl compact="compact">
<dt><code>rssis</code></dt>
<dd><p>Array of object. Each item represents a cell as described in See <a href="#RSSI-notification">RSSI notification</a>.
      </p></dd>
<dt><code>scanning</code></dt>
<dd><p>Boolean. If true, a scanning is in progress.
    </p></dd>
</dl>

</dd>
</dl>

<p>Exemple of scan command:<br>
</p><div class="example">
<pre class="example">./ws.js -t 600 127.0.0.1:9009 '{&quot;message&quot;: &quot;scan&quot;,&quot;band&quot;:[&quot;7(3000)&quot;,&quot;n78&quot;]}'
</pre></div>

<span id="LTE-events"></span><h3 class="section">5.7 LTE events</h3>

<p>Following events are sent by scanner to remote API client if they have been registered on WebSocket.
</p>
<dl compact="compact">
<dt><code>cell</code></dt>
<dd><p>Cell has been scanned. Same definition as See <a href="#Cell-notification">Cell notification</a>.
</p>
</dd>
<dt><code>scan</code></dt>
<dd><p>Provides information on scanning progress
    </p><dl compact="compact">
<dt><code>notification</code></dt>
<dd><p>String. Can be <code>band</code> when a new band is being scanned, <code>end</code> when scanning is over.
    </p></dd>
</dl>
 
</dd>
</dl>

<span id="Examples"></span><h3 class="section">5.8 Examples</h3>

<ol>
<li> Config
    <ol>
<li> Client sends
<pre class="verbatim">{
    &quot;message&quot;: &quot;config_get&quot;,
    &quot;message_id&quot;: &quot;foo&quot;
}
</pre>
</li><li> Server replies
<pre class="verbatim">{
    &quot;message_id&quot;: &quot;foo&quot;,
    &quot;message&quot;: &quot;config_get&quot;,
    &quot;name&quot;: &quot;UE&quot;,
    &quot;logs&quot;: {
        &quot;phy&quot;: {
            &quot;level&quot;: &quot;error&quot;,
            &quot;max_size&quot;: 0
        },
        ...
        &quot;rrc&quot;: {
            &quot;level&quot;: &quot;debug&quot;,
            &quot;max_size&quot;: 1
        }
    }
}
</pre>
</li></ol>

</li><li> Error
    <ol>
<li> Client sends
<pre class="verbatim">{
    &quot;message&quot;: &quot;bar&quot;,
    &quot;message_id&quot;: &quot;foo&quot;
}
</pre>
</li><li> Server replies
<pre class="verbatim">{
    &quot;message_id&quot;: &quot;foo&quot;,
    &quot;message&quot;: &quot;bar&quot;,
    &quot;error&quot;: &quot;Unknown message: bar&quot;
}
</pre>
</li></ol>
</li></ol>



<span id="Command-line-monitor-reference"></span><h2 class="chapter">6 Command line monitor reference</h2>
<p>The following commands are available:
</p>
<dl compact="compact">
<dt><code>help</code></dt>
<dd><p>Display the help. Use <code>help <var>command</var></code> to have a more
detailed help about a command.
</p>
</dd>
<dt><code>t [scan|cpu|spl] [<var>port</var>]</code></dt>
<dd><p>Activate various traces on the console. The display is stopped when
typing return. The default trace is the current scan status.
An optional RF port may be given for cpu and spl traces.
</p>
<p>Available traces:
</p><dl compact="compact">
<dt><code>scan</code></dt>
<dd><p>Display current scan information.
</p></dd>
<dt><code>cpu</code></dt>
<dd><p>Display the CPU usage from the TRX (transceiver) API and the TX-RX
latency statistics.
</p></dd>
<dt><code>spl</code></dt>
<dd><p>Display various statistics about the sent and received complex samples
(at the TRX API level). For the TX side, the RMS and maximum
sample value are displayed. The number of saturation events
(<code>abs(sample) &gt; 1</code>) are displayed too. For the RX side the RMS
and maximum sample value are displayed. The unit is dB FS (dB Full
Scale). 0 dB FS is reached with a square signal of amplitude 1.
</p></dd>
</dl>

</dd>
<dt><code>scan <var>bands</var></code></dt>
<dd><p>Start a cell scan on the specified band(s); LTE band: 1..256; NR band: n1..n256
You can also add arfcn/gscn limits for each band.
Examples:<br>
scan 7 20    will scan bands LTE 7 and 20<br>
scan 7(3000)    scan arfcn 3000 on band LTE 7<br>
scan n78(7838,7850)   scan gscn 7838 to 7850 on band NR 78<br>
</p>

</dd>
<dt><code>scan_rssi <var>bands</var></code></dt>
<dd><p>Start a RSSI scan on the specified band(s); LTE band: 1..256; NR band: n1..n256
</p>
</dd>
<dt><code>com</code></dt>
<dd><p>COM connection status.
</p>
</dd>
</dl>


<span id="Log-file-format"></span><span id="Log-file-format-1"></span><h2 class="chapter">7 Log file format</h2>

<span id="PHY-layer"></span><h3 class="section">7.1 PHY layer</h3>

<p>When a PHY message is dumped (debug level), the format is:
</p><div class="example">
<pre class="example">time layer dir ue_id cell rnti frame.subframe channel:short_content
        long_content
</pre></div>

<dl compact="compact">
<dt><code>time</code></dt>
<dd><p>Time using the selected format.
</p></dd>
<dt><code>layer</code></dt>
<dd><p>Layer (<code>[PHY]</code> here).
</p></dd>
<dt><code>dir</code></dt>
<dd><p>UL (uplink) or DL (downlink).
</p></dd>
<dt><code>ue_id</code></dt>
<dd><p>eNodeB UE identifier (hexadecimal, unique among all cells).
</p></dd>
<dt><code>cell</code></dt>
<dd><p>Low 8 bits of the cell identifier (hexadecimal).
</p></dd>
<dt><code>rnti</code></dt>
<dd><p>Associated RNTI (hexadecimal) or <code>-</code> if none.
</p></dd>
<dt><code>frame.subframe</code></dt>
<dd><p>Frame number (0-1023) and either subframe number (0-9) for LTE and NB-IoT cells or slot number for NR cells.
</p></dd>
<dt><code>channel</code></dt>
<dd><p>PHY channel name (e.g. PUSCH, PUCCH, PRACH, SRS, PSS,
PBCH, PCFICH, PDSCH, PHICH, PDCCH, EPDCCH, ...).
</p></dd>
<dt><code>short_content</code></dt>
<dd><p>Single line content. 
</p></dd>
<dt><code>long_content</code></dt>
<dd><p>Hexadecimal dump of the message if <code>phy.max_size &gt; 0</code>.
</p></dd>
</dl>






<span id="Change-history"></span><h2 class="chapter">8 Change history</h2>


<span id="Version-2024_002d12_002d13"></span><h3 class="section">8.1 Version 2024-12-13</h3>

<ul>
<li> added <code>sib_format_jer</code> parameter
</li></ul>

<span id="Version-2024_002d09_002d13"></span><h3 class="section">8.2 Version 2024-09-13</h3>

<ul>
<li> added LTE bands 107 and 108 definition
</li><li> added <code>mib</code> parameter to cell notification
</li><li> added <code>license</code> remote API
</li><li> <code>com_logs_lock</code> parameter is renamed to <code>com_log_lock</code>. <code>com_logs_lock</code> is still supported for backward compatibility
</li><li> added <code>com_log_us</code> parameter
</li></ul>

<span id="Version-2024_002d06_002d14"></span><h3 class="section">8.3 Version 2024-06-14</h3>

<ul>
<li> OpenSSL library is upgraded to 1.1.1w
</li><li> added NR band 54 definition
</li><li> added <code>lte_m</code> and <code>nsa</code> parameters to cell notification
</li><li> added MIB info for WS API
</li></ul>

<span id="Version-2024_002d03_002d15"></span><h3 class="section">8.4 Version 2024-03-15</h3>

<ul>
<li> added LTE bands 106, 253 and 254 definition
</li><li> added NR bands 31, 72, 105, 109 and 254 definition
</li></ul>

<span id="Version-2023_002d12_002d15"></span><h3 class="section">8.5 Version 2023-12-15</h3>

<ul>
<li> added <code>loop_count</code> and <code>loop_delay</code> to remote API messages
</li><li> added <code>sim_events</code>, <code>sim_events_loop_count</code> and <code>sim_events_loop_delay</code>
</li><li> added <code>com_ssl_ca</code> parameter for SSL verification
</li></ul>

<span id="Version-2023_002d06_002d10"></span><h3 class="section">8.6 Version 2023-06-10</h3>

<ul>
<li> <code>com_logs_lock</code> parameter added to disable logs configuration change via remote API
</li></ul>

<span id="Version-2023_002d03_002d17"></span><h3 class="section">8.7 Version 2023-03-17</h3>

<ul>
<li> <code>com_addr</code> parameter now uses [::] address instead of 0.0.0.0 in the delivered configuration file to allow IPv6 connection
</li></ul>

<span id="Version-2022_002d12_002d16"></span><h3 class="section">8.8 Version 2022-12-16</h3>

<ul>
<li> <code>utc</code> parameter is added to remote API response messages
</li></ul>

<span id="Version-2022_002d06_002d17"></span><h3 class="section">8.9 Version 2022-06-17</h3>

<ul>
<li> OpenSSL library is upgraded to 1.1.1n
</li><li> <code>start_timestamp</code> and <code>end_timestamp</code> are added to <code>log_get</code> API
</li></ul>

<span id="Version-2022_002d03_002d18"></span><h3 class="section">8.10 Version 2022-03-18</h3>

<ul>
<li> Added Introduction
</li><li> Added sample config file
</li><li> Use retransmission to improve all SIB decoding in low SNR conditions
</li><li> Indicate NSA cells
</li><li> Fixed cell detection when SSB spacing is different
</li><li> Fixed BWP parsing
</li></ul>


<span id="License"></span><h2 class="chapter">9 License</h2>

<p><code>ltescan</code> is copyright (C) 2012-2024 Amarisoft. Its redistribution
without authorization is prohibited.
</p>
<p><code>ltescan</code> is available without any express or implied warranty. In
no event will Amarisoft be held liable for any damages arising from
the use of this software.
</p>
<p>For more information on licensing, please refer to <code>license.pdf</code> file.
</p>

<hr>



</body>
</html>
